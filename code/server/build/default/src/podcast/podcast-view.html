<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">

<dom-module id="podcast-view">
  <template>
    <style>
      :host {
        display: block;
      }

      .heading {
        text-align: center;
      }

      .podcast {
        box-shadow: 4px 5px 16px 0px rgba(0,0,0,0.1);
        width: 500px;
        border-radius: 22px;
        background-size: cover;
        background-position: center;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        margin: 20px auto;
      }

      .podcast__title {
        margin-bottom: 10px;
        background-color: black;
      }

      .podcast__date {
        margin-top: 0px;
      }

      .audio {
        margin: 20px 0;
      }
    </style>
    <app-location route="{{route}}"></app-location>
    <app-route route="{{route}}" pattern="/p/:accessUrl" data="{{routeData}}" tail="{{subroute}}"></app-route>
      <firebase-query path="/podcasts" data="{{podcasts}}">
      </firebase-query>
      <template is="dom-repeat" filter="isSelectedPodcast" items="{{podcasts}}" as="podcast">
        <div class="podcast" style="background-image: url({{podcast.imgUrl}})">
          <h1 class="podcast__title">{{podcast.title}}</h1>
          <p class="podcast__date">{{podcast.date}}</p>
          <audio class="audio" controls="">
            <source src="{{podcast.audioUrl}}" type="audio/mpeg">
          Your browser does not support the audio element.
          </audio>
        </div>
      </template>

  </template>

  <script>/**
 * @customElement
 * @polymer
 */
class PodcastView extends Polymer.Element {
  static get is() {
    return 'podcast-view';
  }

  static get properties() {
    return {
      prop1: {
        type: String,
        value: 'podcast-view'
      },
      selectedPodcast: {
        type: Object
      },
      podcast: {
        type: Object,
        notify: true
      },
      key: {
        type: String,
        notify: true
      },
      routeData: {
        type: Object,
        notify: true
      }
    };
  }

  isSelectedPodcast(podcast) {
    return `${podcast.accessUrl}` === `${this.routeData.accessUrl}`;
  }

}

window.customElements.define(PodcastView.is, PodcastView);</script>
</dom-module>
